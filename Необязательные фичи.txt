1 Передавать значение (имя скачиваемого документа пользователем) в url при отправке зашифрованным с помощью токена (а может попробовать через post запрос)(или экранировать, как сказал gpt)
2 Сделать более сильную валидацию, особенно на файл, проверять его MIME тип
3 Сделать так, чтобы пока грузится меню с кнопками, слева кнопки недоступны, чтоы потом куча  кнопок не появлялась